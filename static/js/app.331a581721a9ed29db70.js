webpackJsonp([1],{126:function(e,t,n){"use strict";n.d(t,"a",function(){return a}),n.d(t,"e",function(){return o}),n.d(t,"b",function(){return s}),n.d(t,"c",function(){return i}),n.d(t,"d",function(){return u});var r=n(127),a=function(e){return r.a.post("/tokens",e)},o=function(e){return r.a.get("/users",{params:e})},s=function(e,t){return r.a.patch("/users/"+e,{params:t})},i=function(e){return r.a.post("/users/tags",e)},u=function(e,t){return r.a.delete("/users/tags/"+e,{params:t})}},127:function(e,t,n){"use strict";var r=(n(201),n(202)),a=n(203);n.d(t,"b",function(){return r.a}),n.d(t,"a",function(){return a.a})},178:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(81),a=n(118),o=n.n(a),s=n(470),i=n.n(s),u=n(200),c=n(199),l=(n(198),n(460));n.n(l);r.default.use(o.a),r.default.config.productionTip=!1,new r.default({el:"#app",store:u.a,router:c.a,render:function(e){return e(i.a)}})},198:function(e,t,n){"use strict";var r=n(467),a=n.n(r);a.a.mock("/api/tokens","post",function(){return"token"}),a.a.mock(/\/api\/users*/,function(){return{total:1,users:[{avatarUrl:r.Random.image("250x250"),country:r.Random.city(),createdAt:r.Random.date(),gender:Number(r.Random.boolean()),insider:Number(r.Random.boolean()),nickName:r.Random.name(),name:r.Random.name(),address:r.Random.city(),province:r.Random.province(),city:r.Random.city(),company:r.Random.ctitle(),reported:Number(r.Random.boolean()),sharedAt:r.Random.date(),tags:[],type:Number(r.Random.boolean()),updatedAt:r.Random.date(),__v:0,_id:r.Random.guid()}]}}),a.a.mock("/api/users/:id","patch",function(){return"ok"}),a.a.mock("/api/users/tags","post",function(){return"ok"}),a.a.mock("/api/users/tags/:id","delete",function(){return"ok"})},199:function(e,t,n){"use strict";var r=n(81),a=n(484),o=n(118),s=n.n(o),i=n(471),u=n.n(i),c=n(472),l=n.n(c),d=n(475),p=n.n(d),f=n(476),m=n.n(f),g=n(474),v=n.n(g),h=n(473),b=n.n(h);r.default.use(a.a);var y=new a.a({routes:[{path:"/",component:u.a,redirect:"/users",children:[{path:"users",component:p.a,meta:{title:"用户管理",icon:"person-stalker"},children:[{path:"/users",component:m.a,meta:{title:"用户列表",hidden:!1}}]},{path:"settings",component:v.a,redirect:"/settings/common",meta:{title:"系统设置",icon:"android-settings"},children:[{path:"/settings/common",component:b.a,meta:{title:"公共设置"}}]}]},{path:"/login",component:l.a},{path:"*",component:u.a}]});y.beforeEach(function(e,t,n){return s.a.LoadingBar.start(),sessionStorage.token&&"/login"===e.path?(sessionStorage.removeItem("token"),s.a.Message.warning("注销成功"),n()):sessionStorage.token||"/login"===e.path?n():n({path:"/login",query:{redirect:e.fullPath}})}),y.afterEach(function(){s.a.LoadingBar.finish()}),t.a=y},200:function(e,t,n){"use strict";var r=n(81),a=n(119);r.default.use(a.b);var o=new a.b.Store({state:{user:{},settings:{}},mutations:{USER:function(e,t){e.user=t},SETTINGS:function(e,t){e.settings=t}},actions:{},getters:{}});t.a=o},201:function(e,t,n){"use strict";window.location.host},202:function(e,t,n){"use strict";function r(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"YYYY-MM-DD HH:mm:ss",n=e,r=t;"string"==typeof n&&(n=new Date(n.replace(/-/g,"/"))),"number"==typeof n&&(n=new Date(n));var a={"M+":n.getMonth()+1,"D+":n.getDate(),"h+":n.getHours()%12==0?12:n.getHours()%12,"H+":n.getHours(),"m+":n.getMinutes(),"s+":n.getSeconds(),"q+":Math.floor((n.getMonth()+3)/3),S:n.getMilliseconds()},s={0:"日",1:"一",2:"二",3:"三",4:"四",5:"五",6:"六"};if(/(Y+)/.test(r)&&(r=r.replace(RegExp.$1,String(n.getFullYear()).substr(4-RegExp.$1.length))),/(E+)/.test(r)){var i=void 0;i=RegExp.$1.length>1?RegExp.$1.length>2?"星期":"周":"";var u=""+i+s[String(n.getDay())];r=r.replace(RegExp.$1,u)}return o()(a).forEach(function(e){new RegExp("("+e+")").test(r)&&(r=r.replace(RegExp.$1,1===RegExp.$1.length?a[e]:("00"+a[e]).substr(String(a[e]).length)))}),r}var a=n(213),o=n.n(a);t.a={formate:r}},203:function(e,t,n){"use strict";var r=n(180),a=n.n(r),o=n(118),s=n.n(o),i=a.a.create({baseURL:"/api"});i.interceptors.request.use(function(e){var t=e,n=sessionStorage.token;return n&&(t.headers={Authorization:"Bearer "+n}),t},function(e){s.a.Message.error(e.message)}),i.interceptors.response.use(function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.data&&e.data.msg;if(t)return s.a.Message.error(t),!1;var n=e.headers["set-authorization"];return n&&sessionStorage.setItem("token",n),e.data||!0},function(e){var t=e.response,n=t&&t.data,r=n.msg;return 401===t.status&&sessionStorage.removeItem("token"),s.a.Message.error(r||e.message),!1}),t.a=i},204:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default={name:"app"}},205:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(129),a=n.n(r),o=n(119);t.default={name:"Layout",data:function(){return{activeName:"",openNames:[]}},computed:a()({},n.i(o.a)({settings:"settings"})),created:function(){this.update()},methods:{handleSelect:function(e){this.$router.push(e)},update:function(e){var t=this,n=e?e.path:this.$route.path;this.openNames=[n.split("/")[1]],this.activeName=n,this.$nextTick(function(){t.$refs.menu.updateActiveName(),t.$refs.menu.updateOpened()})}},watch:{$route:function(){this.update()}}}},206:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(130),a=n.n(r),o=n(128),s=n.n(o),i=n(126);t.default={name:"Login",data:function(){return{form:{account:"",password:""},rule:{account:[{required:!0,message:"账号不能为空"}],password:[{required:!0,message:"密码不能为空"}]}}},methods:{handleLogin:function(){var e=this;this.$refs.form.validate(function(){var t=s()(a.a.mark(function t(n){var r;return a.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:if(n){t.next=2;break}return t.abrupt("return");case 2:return t.next=4,i.a(e.form);case 4:if(r=t.sent){t.next=7;break}return t.abrupt("return");case 7:sessionStorage.setItem("token",r),e.$Message.success("登录成功"),e.$router.replace(e.$route.query.redirect||"/");case 10:case"end":return t.stop()}},t,e)}));return function(e){return t.apply(this,arguments)}}())},handleReset:function(){this.$refs.form.resetFields()}}}},207:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(211),a=n.n(r),o=n(129),s=n.n(o),i=n(119);t.default={name:"setting-common",data:function(){return{phone:{data:""}}},computed:s()({},n.i(i.a)({settings:"settings"})),methods:{handleBackgroundChange:function(e){var t={background:e};this.$store.commit("SETTINGS",t),localStorage.setItem("settings",a()(t))}}}},208:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default={name:"settings"}},209:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default={name:"users"}},210:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(130),a=n.n(r),o=n(128),s=n.n(o),i=n(126),u=n(127);t.default={name:"user-list",data:function(){var e=this;return{columns:[{title:"昵称",key:"nickName",width:160,render:function(e,t){return e("div",t.row.nickName||"未知")}},{title:"姓名",key:"name",width:100,render:function(e,t){return e("div",[e("Icon",{props:{type:"person"}}),e("strong",t.row.name||"未知")])}},{title:"公司",key:"company",render:function(e,t){return e("div",t.row.company||"未知")}},{title:"地址",key:"address",width:200,render:function(e,t){return e("div",t.row.address||"未知")}},{title:"标签",key:"tags",render:function(t,n){var r=n.row.tags.map(function(r,a){return t("Tag",{props:{type:"border",closable:!0,color:"blue"},on:{"on-close":function(){e.removeTag(n.index,a)}}},r)});return t("div",r.concat([t("Button",{props:{icon:"ios-plus-empty",type:"dashed",size:"small"},on:{click:function(){e.addTag(n.index)}}})]))}},{title:"操作",key:"action",width:200,align:"center",render:function(t,n){return t("div",[function(){var r=n.row.type>9?"解除管理":"设为管理";return 100===n.row.type&&(r="最高管理"),t("Button",{props:{type:"ghost",size:"small",disabled:100===n.row.type},style:{marginRight:"5px"},on:{click:function(){e.toggleAdmin(n.index)}}},r)}(),t("Button",{props:{type:"primary",size:"small"},style:{marginRight:"5px"},on:{click:function(){e.show(n.index)}}},"查看"),t("Button",{props:{type:"error",size:"small",disabled:100===n.row.type},on:{click:function(){e.forbidden(n.index)}}},-1===n.row.type?"解封":"封禁")])}}],data:[],total:0,search:"",page:1,limit:12,type:"0,1,-1"}},activated:function(){this.getUsers()},methods:{show:function(e){var t=this;return s()(a.a.mark(function n(){var r;return a.a.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:r=t.data[e],t.$Modal.info({title:"用户信息",content:'\n        <img src="'+(r.avatarUrl||"https://miniapp.ourauto.club/logo.jpg")+'" class="avatar"></img><br>\n        昵称：'+(r.nickName||"未知")+"<br>\n        姓名："+(r.name||"未知")+"<br>\n        性别："+t.genderFormat(r.gender)+"<br>\n        公司："+(r.company||"未知")+"<br>\n        地址："+(r.address||"未知")+"<br>\n        手机号："+(r.phone||"未知")+"<br>\n        微信号："+(r.wechat||"未知")+"<br>\n        省市："+(r.province||"")+(r.city||"未知")+"<br>\n        认证情况："+t.authFormat(r.auth)+"<br>\n        会员："+t.insiderFormat(r.insider)+"<br>\n        注册时间："+(r.createdAt?u.b.formate(new Date(r.createdAt)):"未知")+"<br>\n        解封时间："+(r.deadline?u.b.formate(new Date(r.deadline),"YYYY-MM-DD"):"未被封禁")+"<br>\n        被举报次数："+r.reported+"次"});case 2:case"end":return n.stop()}},n,t)}))()},forbidden:function(e){var t=this;return s()(a.a.mark(function n(){var r,o;return a.a.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:if(r=t.data[e],-1!==r.type){n.next=4;break}return t.$Modal.confirm({title:"确认解封？",content:"该操作不可撤销",loading:!0,onOk:function(){var e=s()(a.a.mark(function e(){var n;return a.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,i.b(r._id,{type:0});case 2:if(n=e.sent,t.$Modal.remove(),n){e.next=6;break}return e.abrupt("return");case 6:r.type=0,t.$Message.success("解封成功");case 8:case"end":return e.stop()}},e,t)}));return function(){return e.apply(this,arguments)}}()}),n.abrupt("return");case 4:o=7,t.$Modal.confirm({loading:!0,render:function(e){return e("Form",[e("Form-item",{props:{label:"请输入时长（单位：天）"}},[e("Input-number",{props:{min:1,value:o,autofocus:!0,placeholder:"请输入封禁天数"},on:{input:function(e){o=e}}})])])},onOk:function(){var e=s()(a.a.mark(function e(){var n;return a.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,i.b(r._id,{type:-1,forbiddenDay:o});case 2:if(n=e.sent,t.$Modal.remove(),n){e.next=6;break}return e.abrupt("return");case 6:r.type=-1,t.$Message.success("封禁成功");case 8:case"end":return e.stop()}},e,t)}));return function(){return e.apply(this,arguments)}}()});case 6:case"end":return n.stop()}},n,t)}))()},addTag:function(e){var t=this;return s()(a.a.mark(function n(){var r,o;return a.a.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:r=t.data[e],o=void 0,t.$Modal.confirm({render:function(e){return e("Input",{props:{value:o,autofocus:!0,placeholder:"请输入标签"},on:{input:function(e){o=e}}})},onOk:function(){var e=s()(a.a.mark(function e(){var n;return a.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(o){e.next=3;break}return t.$Message.warning("请输入标签"),e.abrupt("return");case 3:return e.next=5,i.c({user:r._id,tag:o});case 5:if(n=e.sent){e.next=8;break}return e.abrupt("return");case 8:r.tags.push(o),t.$Message.success("添加成功");case 10:case"end":return e.stop()}},e,t)}));return function(){return e.apply(this,arguments)}}()});case 3:case"end":return n.stop()}},n,t)}))()},removeTag:function(e,t){var n=this;return s()(a.a.mark(function r(){var o,s;return a.a.wrap(function(r){for(;;)switch(r.prev=r.next){case 0:return o=n.data[e],r.next=3,i.d(o.tags[t],{user:o._id});case 3:if(s=r.sent){r.next=6;break}return r.abrupt("return");case 6:o.tags.splice(t,1),n.$Message.success("移除成功");case 8:case"end":return r.stop()}},r,n)}))()},toggleAdmin:function(e){var t=this;return s()(a.a.mark(function n(){var r,o,u,c;return a.a.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:if(r=t.data[e],!(r.type<10)){n.next=7;break}o=void 0,u=void 0,t.$Modal.confirm({render:function(e){return e("div",[e("Input",{props:{value:o,autofocus:!0,placeholder:"请输入管理账号"},style:{marginBottom:"20px"},on:{input:function(e){o=e}}}),e("Input",{props:{value:u,autofocus:!0,placeholder:"请输入密码",type:"password"},on:{input:function(e){u=e}}})])},onOk:function(){var e=s()(a.a.mark(function e(){var n;return a.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(u){e.next=3;break}return t.$Message.warning("请输入密码"),e.abrupt("return");case 3:return e.next=5,i.b(r._id,{type:10,password:u,adminid:o});case 5:if(n=e.sent){e.next=8;break}return e.abrupt("return");case 8:r.type=10,t.$Message.success("设置成功");case 10:case"end":return e.stop()}},e,t)}));return function(){return e.apply(this,arguments)}}()}),n.next=14;break;case 7:return n.next=9,i.b(r._id,{type:1});case 9:if(c=n.sent){n.next=12;break}return n.abrupt("return");case 12:r.type=1,t.$Message.success("解除成功");case 14:case"end":return n.stop()}},n,t)}))()},authFormat:function(e){return e?e.person&&e.company?"个人&公司":e.person?"个人":"公司":"尚未完成认证"},insiderFormat:function(e){var t=u.b.formate(e,"YYYY-MM-DD");return e>Date.now()?"是 ("+t+"到期)":"否"},genderFormat:function(e){return 1===e?"男":2===e?"女":"未知"},getUsers:function(){var e=this;return s()(a.a.mark(function t(){var n;return a.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,i.e({search:e.search,type:e.type,page:e.page,limit:e.limit});case 2:if(n=t.sent){t.next=5;break}return t.abrupt("return");case 5:e.data=n.users,e.total=n.total;case 7:case"end":return t.stop()}},t,e)}))()},handleRadioChange:function(){this.page=1,this.getUsers()},handlePageChange:function(e){this.page=e,this.getUsers()},handlePageSizeChange:function(e){this.limit=e,this.getUsers()}}}},460:function(e,t){},461:function(e,t){},462:function(e,t){},463:function(e,t){},464:function(e,t){},465:function(e,t){},470:function(e,t,n){var r=n(46)(n(204),n(478),null,null,null);e.exports=r.exports},471:function(e,t,n){function r(e){n(464),n(465)}var a=n(46)(n(205),n(482),r,"data-v-ceba4520",null);e.exports=a.exports},472:function(e,t,n){function r(e){n(463)}var a=n(46)(n(206),n(481),r,null,null);e.exports=a.exports},473:function(e,t,n){function r(e){n(461)}var a=n(46)(n(207),n(477),r,null,null);e.exports=a.exports},474:function(e,t,n){var r=n(46)(n(208),n(480),null,null,null);e.exports=r.exports},475:function(e,t,n){var r=n(46)(n(209),n(483),null,null,null);e.exports=r.exports},476:function(e,t,n){function r(e){n(462)}var a=n(46)(n(210),n(479),r,null,null);e.exports=a.exports},477:function(e,t){e.exports={render:function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"setting-common"},[n("Form",[n("Form-item",{attrs:{label:"必应背景"}},[n("i-switch",{attrs:{value:e.settings.background,size:"large"},on:{"on-change":e.handleBackgroundChange}},[n("span",{slot:"open"},[e._v("开启")]),n("span",{slot:"close"},[e._v("关闭")])])],1)],1)],1)},staticRenderFns:[]}},478:function(e,t){e.exports={render:function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{attrs:{id:"app"}},[n("router-view")],1)},staticRenderFns:[]}},479:function(e,t){e.exports={render:function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"users"},[n("div",{staticClass:"actions-form"},[n("Radio-group",{attrs:{type:"button"},on:{"on-change":e.handleRadioChange},model:{value:e.type,callback:function(t){e.type=t},expression:"type"}},[n("Radio",{attrs:{label:"0,1,-1"}},[e._v("普通用户")]),n("Radio",{attrs:{label:"-1"}},[e._v("封禁用户")]),n("Radio",{attrs:{label:"10,100"}},[e._v("管理用户")])],1),n("Form",[n("Input",{attrs:{placeholder:"请输入 昵称 / 姓名 / 标签"},on:{"on-enter":e.getUsers},model:{value:e.search,callback:function(t){e.search=t},expression:"search"}}),n("Button",{attrs:{type:"primary"},nativeOn:{click:function(t){e.getUsers(t)}}},[e._v("查询")])],1)],1),n("div",{staticClass:"data-table"},[n("Table",{staticStyle:{"margin-bottom":"15px"},attrs:{border:"border",columns:e.columns,data:e.data}})],1),n("Page",{attrs:{placement:"top","show-sizer":"show-sizer","page-size":e.limit,"page-size-opts":[12,16,20],total:e.total,current:e.page,"show-total":"show-total","show-elevator":"show-elevator"},on:{"on-page-size-change":e.handlePageSizeChange,"on-change":e.handlePageChange}})],1)},staticRenderFns:[]}},480:function(e,t){e.exports={render:function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("keep-alive",[n("router-view")],1)},staticRenderFns:[]}},481:function(e,t){e.exports={render:function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"login"},[n("div",{staticClass:"login-bg"}),n("div",{staticClass:"login-bg-cover"}),n("Card",{staticClass:"login-card"},[n("p",{slot:"title"},[e._v("iview后台管理系统")]),n("Form",{ref:"form",attrs:{model:e.form,rules:e.rule,"label-width":60,"label-position":"left"}},[n("Form-item",{attrs:{label:"账号",prop:"account"}},[n("Input",{attrs:{placeholder:"请输入账号"},on:{"on-enter":e.handleLogin},model:{value:e.form.account,callback:function(t){e.form.account=t},expression:"form.account"}})],1),n("Form-item",{attrs:{label:"密码",prop:"password"}},[n("Input",{attrs:{type:"password",placeholder:"请输入密码"},on:{"on-enter":e.handleLogin},model:{value:e.form.password,callback:function(t){e.form.password=t},expression:"form.password"}})],1),n("Form-item",[n("Button",{attrs:{type:"primary"},on:{click:e.handleLogin}},[e._v("登录")]),n("Button",{staticStyle:{"margin-left":"8px"},attrs:{type:"ghost"},on:{click:e.handleReset}},[e._v("重置")])],1)],1)],1)],1)},staticRenderFns:[]}},482:function(e,t){e.exports={render:function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"layout"},[e.settings.background?n("div",{staticClass:"login-bg"}):e._e(),e.settings.background?n("div",{staticClass:"login-bg-cover"}):e._e(),n("div",{staticClass:"layout-header"},[n("div",{staticClass:"logo"}),n("div",{staticClass:"title"},[e._v("后台管理系统")]),n("span",[e._v(" ")]),n("router-link",{staticClass:"logout",attrs:{to:"/login"}},[e._v("[注销]")])],1),n("div",{staticClass:"layout-body"},[n("div",{staticClass:"layout-menu"},[n("Menu",{ref:"menu",attrs:{width:"auto",accordion:"accordion","open-names":e.openNames,"active-name":e.activeName},on:{"on-select":e.handleSelect}},e._l(e.$router.options.routes[0].children,function(t){return n("Submenu",{key:t.path,attrs:{name:t.path}},[n("template",{slot:"title"},[n("Icon",{attrs:{type:t.meta.icon||"ios-navigate"}}),n("span",{staticClass:"layout-text"},[e._v(e._s(t.meta.title))])],1),e._l(t.children,function(t){return t.meta.hidden?e._e():n("Menu-item",{key:t.path,attrs:{name:t.path}},[e._v(e._s(t.meta.title))])})],2)}))],1),n("div",{staticClass:"layout-content"},[n("div",{staticClass:"layout-breadcrumb"},[n("Breadcrumb",e._l(e.$route.matched,function(t){return n("Breadcrumb-item",{key:t.path},[e._v(e._s(t.meta.title||"首页"))])}))],1),n("div",{staticClass:"layout-content-main"},[n("router-view")],1),n("div",{staticClass:"layout-copy"},[e._v("2017 © Ourauto")])])])])},staticRenderFns:[]}},483:function(e,t){e.exports={render:function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("keep-alive",[n("router-view")],1)},staticRenderFns:[]}},486:function(e,t,n){n(179),e.exports=n(178)}},[486]);